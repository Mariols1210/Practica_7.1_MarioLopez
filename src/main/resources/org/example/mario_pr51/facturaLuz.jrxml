<!-- Created with Jaspersoft Studio version 7.0.1.final using JasperReports Library version 7.0.1-573496633c2b4074e32f433154b543003f7d2498  -->
<jasperReport name="Flower_Table_Based" language="java" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="535" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="5021b7ab-4d36-456c-9e0a-66c9724f9ebb">
	<property name="template.engine" value="tabular_template"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="687"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="Practica5DB"/>
	<style name="Title" forecolor="#FFFFFF" fontName="Times New Roman" fontSize="50.0" bold="false"/>
	<style name="SubTitle" forecolor="#666666" fontName="Times New Roman" fontSize="18.0" bold="false"/>
	<style name="Column header" forecolor="#666666" fontName="Times New Roman" fontSize="14.0" bold="true"/>
	<style name="Detail" mode="Transparent" fontName="Times New Roman" pdfFontName="Times-Roman"/>
	<style name="Row" mode="Transparent" fontName="Times New Roman" pdfFontName="Times-Roman">
		<conditionalStyle mode="Opaque" backcolor="#F0EFEF">
			<conditionExpression><![CDATA[$V{REPORT_COUNT}%2 == 0]]></conditionExpression>
		</conditionalStyle>
	</style>
	<style name="Table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
			<topPen lineWidth="1.0" lineColor="#000000"/>
			<leftPen lineWidth="1.0" lineColor="#000000"/>
			<bottomPen lineWidth="1.0" lineColor="#000000"/>
			<rightPen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<dataset name="PieChartDataset" uuid="33d77d72-cefc-44b5-96f2-92f62ab217b3"/>
	<query language="sql"><![CDATA[SELECT 
    c.*,
    f.*,
    ct.*,
    t.*,
    (ct.consumo_kwh * ct.precio_kwh) as importe_por_tramo,
    (
        SELECT SUM(ct2.consumo_kwh * ct2.precio_kwh)
        FROM CONSUMO_TRAMO ct2
        WHERE ct2.id_factura = f.id_factura
    ) as total_factura_calculado
FROM FACTURA f
JOIN CLIENTE c ON f.id_cliente = c.id_cliente
JOIN CONSUMO_TRAMO ct ON f.id_factura = ct.id_factura
LEFT JOIN TARIFA t ON ct.tramo = t.tramo]]></query>
	<field name="id_cliente" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="id_cliente"/>
		<property name="com.jaspersoft.studio.field.label" value="id_cliente"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CLIENTE"/>
	</field>
	<field name="nombre" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="nombre"/>
		<property name="com.jaspersoft.studio.field.label" value="nombre"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CLIENTE"/>
	</field>
	<field name="apellidos" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="apellidos"/>
		<property name="com.jaspersoft.studio.field.label" value="apellidos"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CLIENTE"/>
	</field>
	<field name="nif" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="nif"/>
		<property name="com.jaspersoft.studio.field.label" value="nif"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CLIENTE"/>
	</field>
	<field name="direccion" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="direccion"/>
		<property name="com.jaspersoft.studio.field.label" value="direccion"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CLIENTE"/>
	</field>
	<field name="telefono" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="telefono"/>
		<property name="com.jaspersoft.studio.field.label" value="telefono"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CLIENTE"/>
	</field>
	<field name="email" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="email"/>
		<property name="com.jaspersoft.studio.field.label" value="email"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CLIENTE"/>
	</field>
	<field name="id_factura" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="id_factura"/>
		<property name="com.jaspersoft.studio.field.label" value="id_factura"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="COLUMN_9" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="id_cliente"/>
		<property name="com.jaspersoft.studio.field.label" value="id_cliente"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="numero_factura" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="numero_factura"/>
		<property name="com.jaspersoft.studio.field.label" value="numero_factura"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="fecha_emision" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="fecha_emision"/>
		<property name="com.jaspersoft.studio.field.label" value="fecha_emision"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="periodo_inicio" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="periodo_inicio"/>
		<property name="com.jaspersoft.studio.field.label" value="periodo_inicio"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="periodo_fin" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="periodo_fin"/>
		<property name="com.jaspersoft.studio.field.label" value="periodo_fin"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="total_factura" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="total_factura"/>
		<property name="com.jaspersoft.studio.field.label" value="total_factura"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="estado" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="estado"/>
		<property name="com.jaspersoft.studio.field.label" value="estado"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="FACTURA"/>
	</field>
	<field name="id_detalle" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="id_detalle"/>
		<property name="com.jaspersoft.studio.field.label" value="id_detalle"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CONSUMO_TRAMO"/>
	</field>
	<field name="COLUMN_17" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="id_factura"/>
		<property name="com.jaspersoft.studio.field.label" value="id_factura"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CONSUMO_TRAMO"/>
	</field>
	<field name="tramo" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="tramo"/>
		<property name="com.jaspersoft.studio.field.label" value="tramo"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CONSUMO_TRAMO"/>
	</field>
	<field name="consumo_kwh" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="consumo_kwh"/>
		<property name="com.jaspersoft.studio.field.label" value="consumo_kwh"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CONSUMO_TRAMO"/>
	</field>
	<field name="precio_kwh" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="precio_kwh"/>
		<property name="com.jaspersoft.studio.field.label" value="precio_kwh"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="CONSUMO_TRAMO"/>
	</field>
	<field name="id_tarifa" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="id_tarifa"/>
		<property name="com.jaspersoft.studio.field.label" value="id_tarifa"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="TARIFA"/>
	</field>
	<field name="COLUMN_22" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="tramo"/>
		<property name="com.jaspersoft.studio.field.label" value="tramo"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="TARIFA"/>
	</field>
	<field name="precio_base" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="precio_base"/>
		<property name="com.jaspersoft.studio.field.label" value="precio_base"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="TARIFA"/>
	</field>
	<field name="descripcion" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="descripcion"/>
		<property name="com.jaspersoft.studio.field.label" value="descripcion"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="TARIFA"/>
	</field>
	<field name="importe_por_tramo" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="importe_por_tramo"/>
		<property name="com.jaspersoft.studio.field.label" value="importe_por_tramo"/>
	</field>
	<field name="total_factura_calculado" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="total_factura_calculado"/>
		<property name="com.jaspersoft.studio.field.label" value="total_factura_calculado"/>
	</field>
	<title height="94" splitType="Stretch">
		<element kind="frame" uuid="184ed0d3-9801-4c46-ba21-3cc37a3a18f0" mode="Opaque" x="-20" y="0" width="597" height="65" forecolor="#006699" backcolor="#006699">
			<element kind="staticText" uuid="745f25f7-7025-4153-981e-c7b55b127c2d" x="330" y="0" width="247" height="65" fontSize="54.0" bold="false" hTextAlign="Right" style="Title">
				<text><![CDATA[ElectriCity]]></text>
			</element>
			<element kind="staticText" uuid="649287ac-fc0c-4d2a-b452-b8614b1d7b48" x="360" y="70" width="217" height="29" fontSize="22.0" bold="false" hTextAlign="Right" style="SubTitle">
				<text><![CDATA[Mario López Sanmartín]]></text>
			</element>
			<element kind="staticText" uuid="b92d88a6-6842-455d-942b-da55ea69eb5d" x="20" y="20" width="197" height="40" fontSize="32.0" bold="false" hTextAlign="Right" style="Title">
				<text><![CDATA[Factura de luz]]></text>
			</element>
		</element>
	</title>
	<columnHeader height="165">
		<element kind="textField" uuid="894fee11-5208-4722-af85-4cae1c38b5a5" x="389" y="50" width="140" height="25" fontSize="16.0">
			<expression><![CDATA[$F{direccion}]]></expression>
		</element>
		<element kind="textField" uuid="052f7e50-af80-46a7-b83d-3adcd67d2ecb" x="389" y="110" width="163" height="30" fontSize="16.0">
			<expression><![CDATA[$F{email}]]></expression>
		</element>
		<element kind="staticText" uuid="32ee857a-0d87-4d18-8fa8-b838f65c6793" x="-1" y="80" width="100" height="25" fontSize="16.0" vTextAlign="Middle">
			<text><![CDATA[Apellidos:]]></text>
		</element>
		<element kind="staticText" uuid="c26196ea-b313-4f89-8f16-6b46cc579dac" x="279" y="50" width="100" height="25" fontSize="16.0" vTextAlign="Middle">
			<text><![CDATA[Dirección:]]></text>
		</element>
		<element kind="staticText" uuid="5e23c25c-1934-4e31-91e0-213712f901da" x="279" y="80" width="100" height="25" fontSize="16.0" vTextAlign="Middle">
			<text><![CDATA[Teléfono:]]></text>
		</element>
		<element kind="staticText" uuid="2b21d8fa-5630-4253-b6d5-1ff4fd363578" x="-1" y="50" width="100" height="25" fontSize="16.0" vTextAlign="Middle">
			<text><![CDATA[Nombre:]]></text>
		</element>
		<element kind="textField" uuid="2fdc373d-0359-4e6c-8358-1497cd454f7b" x="109" y="110" width="100" height="25" fontSize="16.0">
			<expression><![CDATA[$F{nif}]]></expression>
		</element>
		<element kind="textField" uuid="4db5e21a-df3e-4d1f-a563-526f3ecd0015" x="109" y="50" width="100" height="25" fontSize="16.0">
			<expression><![CDATA[$F{nombre}]]></expression>
		</element>
		<element kind="staticText" uuid="5b5ae3cb-0d31-4e11-a5f7-b5f0066e8c53" x="279" y="110" width="100" height="25" fontSize="16.0" vTextAlign="Middle">
			<text><![CDATA[Email:]]></text>
		</element>
		<element kind="staticText" uuid="8614ba97-534a-4552-9f7e-7e40696d1e88" x="-1" y="110" width="100" height="25" fontSize="16.0" vTextAlign="Middle">
			<text><![CDATA[NIF:]]></text>
		</element>
		<element kind="textField" uuid="7d9fcd8e-1928-4da9-bf04-8484ebbb4388" x="389" y="80" width="140" height="25" fontSize="16.0">
			<expression><![CDATA[$F{telefono}]]></expression>
		</element>
		<element kind="staticText" uuid="c02d5f8c-a3dc-427b-a50c-ef1f8603f8bf" x="-1" y="10" width="201" height="30" fontName="SansSerif" fontSize="19.0" bold="true">
			<text><![CDATA[Datos del cliente:]]></text>
		</element>
		<element kind="textField" uuid="56238d77-8e80-42cb-bb8e-d8477076828a" x="109" y="80" width="131" height="25" fontSize="16.0">
			<expression><![CDATA[$F{apellidos}]]></expression>
		</element>
	</columnHeader>
	<detail>
		<band height="495">
			<element kind="staticText" uuid="7157180c-e384-40d4-8a3f-e8021607a67c" x="4" y="100" width="95" height="25" fontSize="16.0" vTextAlign="Middle">
				<text><![CDATA[Fecha inicio:]]></text>
			</element>
			<element kind="staticText" uuid="f50a6047-5cea-495f-b33e-d8cfd776744f" x="120" y="100" width="140" height="30" fontSize="16.0">
				<text><![CDATA[periodo_inicio]]></text>
			</element>
			<element kind="staticText" uuid="8de7c5d2-9310-408b-aaf6-01e21b1ea450" x="120" y="140" width="100" height="30" fontSize="16.0">
				<text><![CDATA[periodo_fin]]></text>
			</element>
			<element kind="staticText" uuid="a4785d46-4b75-490e-85ff-761b148059d0" x="120" y="60" width="140" height="30" fontSize="16.0">
				<text><![CDATA[fecha_emision]]></text>
			</element>
			<element kind="staticText" uuid="05153a4d-ad49-4e17-9d22-cb049429561f" x="0" y="60" width="120" height="25" fontSize="16.0" vTextAlign="Middle">
				<text><![CDATA[Fecha emisión: ]]></text>
			</element>
			<element kind="staticText" uuid="855a451f-6b77-40be-9814-6cc4ee51a726" x="0" y="140" width="99" height="25" fontSize="16.0" vTextAlign="Middle">
				<text><![CDATA[Fecha fin:]]></text>
			</element>
			<element kind="staticText" uuid="3f68ff10-0cae-4cc5-88b1-1318df9844ed" x="0" y="20" width="230" height="30" fontName="SansSerif" fontSize="19.0" bold="true">
				<text><![CDATA[Detalle de la factura:]]></text>
			</element>
			<element kind="staticText" uuid="9a88af06-b8e2-4d37-ad7e-087d9f575d75" x="0" y="210" width="230" height="30" fontName="SansSerif" fontSize="19.0" bold="true">
				<text><![CDATA[Detalle tramo horario:]]></text>
			</element>
			<element kind="staticText" uuid="f0d05730-0b83-42a1-bbb2-73dae7740786" x="0" y="240" width="152" height="25" fontSize="16.0" vTextAlign="Middle">
				<text><![CDATA[Consumo del tramo:]]></text>
			</element>
			<element kind="staticText" uuid="3ca24456-8501-4d2c-a5fb-8c2e9627afb4" x="0" y="280" width="130" height="25" fontSize="16.0" vTextAlign="Middle">
				<text><![CDATA[Precio del tramo:]]></text>
			</element>
			<element kind="staticText" uuid="7254bfb1-61c7-45b1-be4d-34031486270e" x="0" y="320" width="140" height="25" fontSize="16.0" vTextAlign="Middle">
				<text><![CDATA[Importe del tramo:]]></text>
			</element>
			<element kind="textField" uuid="403c211c-729d-4468-b2ad-760d4ee6838e" x="150" y="240" width="155" height="25" fontSize="16.0" vTextAlign="Middle">
				<expression><![CDATA[$F{consumo_kwh}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="8b66c072-17c1-4f53-a58a-756e222c028f"/>
			</element>
			<element kind="textField" uuid="1f8e12d5-ad48-4c60-86cb-9abe55435eb0" x="140" y="280" width="137" height="25" fontSize="16.0" vTextAlign="Middle">
				<expression><![CDATA[$F{precio_kwh}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="0e9f173c-a816-44d4-b429-1dd82bdbcdeb"/>
			</element>
			<element kind="textField" uuid="de48b33e-5a1b-4944-b365-c47a7398c33f" x="140" y="320" width="166" height="25" fontSize="16.0" vTextAlign="Middle">
				<expression><![CDATA[$F{importe_por_tramo}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3cabd97f-3b43-488c-ab34-0dc92b90f457"/>
			</element>
			<element kind="staticText" uuid="1359d31d-6d26-4e4d-9b9a-0d393ea4d368" x="0" y="410" width="180" height="30" fontName="SansSerif" fontSize="19.0" bold="true">
				<text><![CDATA[Total de la factura:]]></text>
			</element>
			<element kind="textField" uuid="678adcfd-e542-4cb9-af0e-e2c90d2080e6" x="190" y="410" width="199" height="30" fontSize="16.0" vTextAlign="Middle">
				<expression><![CDATA[$F{total_factura_calculado}]]></expression>
				<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="909b6023-8e20-4130-8f7f-64f207864458"/>
			</element>
			<element kind="chart" chartType="bar" uuid="13c44722-f434-4920-b143-87312bc083ce" x="279" y="0" width="266" height="200" evaluationTime="Report">
				<dataset kind="category">
					<series>
						<seriesExpression><![CDATA["CONSUMO"]]></seriesExpression>
						<categoryExpression><![CDATA[$F{tramo}]]></categoryExpression>
						<valueExpression><![CDATA[$F{consumo_kwh}]]></valueExpression>
						<labelExpression><![CDATA[$F{consumo_kwh}.toString()]]></labelExpression>
					</series>
				</dataset>
				<plot categoryAxisLabelColor="#000000" categoryAxisTickLabelColor="#000000" categoryAxisLineColor="#000000" valueAxisLabelColor="#000000" valueAxisTickLabelColor="#000000" valueAxisLineColor="#000000">
					<itemLabel/>
				</plot>
			</element>
		</band>
	</detail>
	<pageFooter height="13" splitType="Stretch">
		<element kind="frame" uuid="38532e1d-6af6-4e2c-9e72-b46a93e345aa" mode="Opaque" x="2" y="0" width="555" height="13" forecolor="#D0B48E" backcolor="#006699">
			<element kind="textField" uuid="0c354c8c-8e51-4e78-961f-18b288231268" x="510" y="0" width="40" height="13" forecolor="#FFFFFF" fontSize="10.0" evaluationTime="Report" bold="false" vTextAlign="Middle" style="Column header">
				<expression><![CDATA[" " + $V{PAGE_NUMBER}]]></expression>
			</element>
			<element kind="textField" uuid="9fb2c5f1-8ad5-4a4b-be6c-eea548125c43" x="430" y="0" width="80" height="13" forecolor="#FFFFFF" fontSize="10.0" bold="false" hTextAlign="Right" vTextAlign="Middle" style="Column header">
				<expression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></expression>
			</element>
			<element kind="textField" uuid="a011f8b7-ada3-40f2-b40a-324c1159d074" x="2" y="0" width="197" height="13" forecolor="#FFFFFF" fontSize="10.0" pattern="EEEEE dd MMMMM yyyy" bold="false" vTextAlign="Middle" style="Column header">
				<expression><![CDATA[new java.util.Date()]]></expression>
			</element>
		</element>
	</pageFooter>
</jasperReport>
